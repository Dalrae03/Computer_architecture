# 4단원 - CPU의 작동 원리

## ALU와 제어장치

- **산술연산장치 (ALU)**

→ CPU 내부에서 레지스터와 제어장치로부터 받아들인 피연산자와 제어 신호로 산술 연산, 논리 연산 등 다양한 연산을 수행하는 장치<br>
(CPU 내부: ALU, 레지스터, 제어 장치)

<br>

<u>받아들이는 정보</u>: 레지스터를 통해 피연산자, 제어장치로 부터 제어신호

<u>내보내는 정보</u>: 레지스터에 결괏값, 플래그 레지스터에 플래그

<br>

- 플래그

→ 연산 결과에 대한 추가적인 상태 정보

대표적: 부호 플래그, 제로 플래그, 캐리 플래그, 오버플로우 플래그, 인터럽트 플래그, 슈퍼바이저 플래그

플래그들은 <u>플래그 레지스터</u>에 저장

→ 플래그 레지스터들은 기본값 ‘0’. ‘1’로 바뀔 경우 해당 플래그가 적용됐다는 소리

<br>

+) 오버 플로우

→ 연산 결과가 연산결과를 담을 레지스터보다 큰 상황

<br>
<br>

- **제어장치**

→ 제어 신호를 내보내고 명령어를 해석하는 부품

제어 신호: 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호

<br>

<u>받아들이는 정보</u>: 클럭 신호, 명령어 레지스터에서 해석할 명령어, 플래그 레지스터에서 플래그 값, 제어버스를 통해 외부로 부터 전달된 제어 신호 등

<u>내보내는 정보</u>: CPU외부에 전달하는 제어신호, CPU내부에 전달하는 제어신호

<br>

<u>CPU외부에 전달하는 제어신호 </u> ⇒ 제어버스로 제어신호를 내보낸다. (메모리에 전달, (보조기억장치 포함) 입출력장치에 전달)

<u>CPU내부에 전달하는 제어신호</u> ⇒ ALU 전달 제어 신호 (수행할 연산 지시), 레지스터에 전달하는 제어 신호 (레지스터 간 데이터 이동시키거나 레지스터에 저장된 명령어를 해석하기 위해).

<br>

+) 클럭 - 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위

<br>
<br>
<br>

## 레지스터

- **레지스터**

→ 프로그램 속 명령어와 데이터가 실행 전후로 저장되는 CPU 내부의 작은 임시 저장 장치

<br>

- 레지스터의 종류
    - 프로그램 카운터 (명령어 포인터) - 메모리에서 읽어들일 명령어의 주소 저장
    - 명령어 레지스터 - 방금 메모리에서 읽어 들인 명령어를 저장하는 레지스터 (제어장치는 명령어 레지스터 속 명령어를 받아들이고 해석한뒤 제어신호를 내보낸다)
    - 메모리 주소 레지스터 - 메모리의 주소 저장
    - 메모리 버퍼 레지스터 (메모리 데이터 레지스터) - 메모리와 주고받을 값 (데이터와 명령어)을 저장하는 레지스터
    - 범용 레지스터 - 데이터와 주소를 모두 저장할 수 있는 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터
    - 플래그 레지스터 - 연산결과 or CPU상태에 대한 부가적인 정보를 저장

<br>

- 대강의 과정

프로그램 카운터 → 메모리 주소 레지스터 → 메모리 주소 레지스터와 제어신호가 메모리로 감 → 메모리에서 데이터를 읽어서 메모리 버퍼 레지스터로 감, 프로그램 카운터는 주소 번호 증가 (다음 명령어 읽어 들일 준비) → 메모리 버퍼 레지스터의 값이 명령어 레지스터로 → 제어장치는 명령어 레지스터의 명령어 해석, 제어신호 발생 

<br>
<br>

### 특정 레지스터를 이용한 주소 지정 방식

- **스택 주소 지정 방식**

→ 스택과 스택 포인터(스택에 마지막으로 저장한 값의 위치를 저장하는 레지스터)를 이용한 주소 지정 방식

<br>

스택 영역: 메모리 안에 스택처럼 사용할 영역이 정해진 곳

<br>
<br>

- **변위 주소 지정 방식**

→ 오퍼랜드 필드의 값과 특정 레지스터 값을 더해 유효 주소를 얻어내는 방식

오퍼랜드 필드의 주소와 어떤 레지스터를 더하는지에 따라 상대 주소 지정 방식, 베이스 레지스터 주소 지정 방식 등으로 나뉨

<br>

- 명령어 구조

| 연산코드 | 레지스터 | 오퍼랜드 |
| --- | --- | --- |
| 이런 내용을 수행해라 | 이 레지스터 값과 | 이 주소를 더한 곳에 있는 데이터로 |

<br>

- <u>상대 주소 지정 방식</u>

→ 오퍼랜드와 프로그램 카운터의 값을 더하여 유효주소를 얻는 방식

프로그램 카운터의 값을 기준으로 오퍼랜드의 수만큼 앞뒤로 이동한 번지 레지스터를 실행.

분기하여 특정 주소의 코드를 실행할 때 사용

<br>

- <u>베이스 레지스터 주소 지정 방식</u>

→ 오퍼랜드와 베이스 레지스터의 값을 더하여 유효주소를 얻는 방식

베이스 레지스터 안의 기준 주소에 오퍼랜드 값만큼의 떨어진 번지의 코드 실행.

<br>
<br>
<br>